@model ZamiuxFixer.Domain.Questions.Question
@using System.Security.Claims
@using ZamiuxFixer.Application.Convertor
@using ZamiuxFixer.Domain.Questions

@{
    int UserId = 0;
    string styleFav = "";
    if (User.Identity.IsAuthenticated == true)
    {
        var user_temp = Context.User.FindFirst("UserID").Value;
        UserId = int.Parse(user_temp);
        if (Model.QuestionFavorites.Any(f => f.UserId == UserId && f.QuestionId == Model.QuestionId))
        {
            styleFav = "color:#ffb301";
        }
    }
    Layout = null;

    List<Answer> answers = ViewBag.Answers as List<Answer>;
}




<!DOCTYPE html>
<html class="no-js" dir="rtl" lang="fa-IR">
<head>
    <meta charset="UTF-8">
    <title> باگ فیکسر </title>
    <meta name="googlebot" content="index,follow">
    <meta name="robots" content="noodp,noydir">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap-rtl.min.css">
    <link rel="stylesheet" type="text/css" href="/css/bugfixer.css">
    <link rel="stylesheet" type="text/css" href="/css/public.css">
    <link rel="stylesheet" type="text/css" href="/css/page.css">
    <link rel="stylesheet" type="text/css" href="/css/question.css">
    <script src="/js/jquery.min.js"></script>
</head>
<body>
    <script src="/js/modernizr.js"></script>

    <header class="main-header">
        <div class="container">
            <nav>
                <span><i class="icon-menu-2"></i></span>
                <div class="inner">
                    <ul>
                        <li><a href=""> تگ ها </a></li>
                        <li><a href=""> پرسش و پاسخ ها </a></li>
                        <li><a href=""> کاربران </a></li>
                        <li><a href=""> راهنمای سایت </a></li>
                    </ul>
                    <div class="clientarea-layer">
                        @if (User.Identity.IsAuthenticated == true)
                        {
                            @await Component.InvokeAsync("UserProfile")
                        }
                        else
                        {
                            <div class="signout-status">
                                <i class="icon-profile"></i>
                                <a href="/Login"> ورود / </a>
                                <a href="/Register"> عضویت </a>
                            </div>
                        }

                    </div>
                </div>
            </nav>

            <a href="" class="logo"><img src="/images/logo-dark.svg"></a>
        </div>
    </header>

    <div class="user-page-style">

        <div class="breadcumb-layer">
            <div class="container">
                <ul itemtype="http://schema.org/BreadcrumbList" class="breadcrumb">
                    <li itemtype="http://schema.org/ListItem" itemscope itemprop="itemListElement"><a href="/" itemprop="item"><span itemprop="name"> باگ فیکسر </span></a></li>
                    <li itemtype="http://schema.org/ListItem" itemscope itemprop="itemListElement"><a href="/Questions" itemprop="item"><span itemprop="name"> پرسش ها </span></a></li>
                    <li itemtype="http://schema.org/ListItem" itemscope itemprop="itemListElement"><a href="/Show-Question/@Model.QuestionId" itemprop="item"><span itemprop="name"> @Model.Title </span></a></li>
                </ul>
            </div>
        </div>

        <div class="questions-layer page-style">

            <div class="container">

                <div class="right-col">
                    <!-- question content -->
                    <section class="question-content-layer">

                        <header>

                            <!-- use this button for edit Post , show only for author -->
                            @if (User.Identity.IsAuthenticated == true)
                            {
                                <a href="/Edit-Question/@Model.QuestionId"><i class="icon-pencil-edit"></i></a>
                            }

                            <h1><a href="/Show-Question/@Model.QuestionId"> @Model.Title </a></h1>
                            <span> @Model.CreateDate.ToShamsi() </span>
                            <span><i> @Model.QuestionVisit </i> بازدید </span>
                            <span><i> @Model.Answers.Count() </i> پاسخ </span>
                            <span><i id="fav_q"> @Model.QuestionFavorites?.Count() </i> رای </span>
                            <span><i id="vote_q"> 3 </i> امتیاز </span>

                        </header>

                        <article>
                            <div class="inner">
                                <!-- Be sure to use this tag -->
                                <header><h2> @Model.Title : </h2></header>
                                <!-- /Be sure to use this tag -->
                                <p>
                                    @Html.Raw(Model.Description)
                                </p>

                                <div class="rating-layer">
                                    <div class="scoring-layer">
                                        <button class="plus" onclick="Vote(@Model.QuestionId,'True')"><i class="icon-caret-up"></i></button>
                                        <span> 0 </span>
                                        <button class="negative" onclick="Vote(@Model.QuestionId,'false')"><i class="icon-caret-down"></i></button>
                                    </div>
                                    <div class="star-rating">
                                        <!-- if user rate this post , use " active " class for Button and disabled this -->
                                        <!-- <button class="active"><i class="icon-star"></i></button> -->
                                        <button onclick="AddToFav(@Model.QuestionId)"><i style="@styleFav" class="icon-star"></i></button>
                                        <span id="span_fav"> @Model.QuestionFavorites?.Count() </span>
                                    </div>
                                </div>

                            </div>

                            <div class="detail-layer">
                                <div class="author">
                                    <a href="" class="img-layer">
                                        <img src="/images/Avatars/@Model.User.Avatar">
                                    </a>
                                    <h3><a href="/ShowProfile/@Model.UserId"> @Model.User.UserName </a></h3>
                                    <span><i>@Model.User.Questions.Count()</i> پرسش | <i>@Model.Answers.Count()</i> پاسخ</span>
                                </div>
                                <a href="javascript:void(0)"> <i class="icon-back-arrow"></i> ثبت پاسخ به این پرسش </a>
                                <div class="share-layer">
                                    <span> به اشتراک گذاری </span>
                                    <div class="share-detail">
                                        <div class="short-link">
                                            <p> لینک کوتاه شامل شناسه شما </p>
                                            <input type="text" name="" readonly value="https://localhost:7235/q/@Model.QuestionId">
                                        </div>
                                        <div class="socials">
                                            <a href=""><i class="icon-facebook"></i></a>
                                            <a href=""><i class="icon-twitter"></i></a>
                                            <a href=""><i class="icon-linkedin"></i></a>
                                            <a href=""><i class="icon-telegram"></i></a>
                                            <a href=""><i class="icon-google-plus"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </article>

                        <!-- tags -->
                        @if (Model.QuestionTags.Count > 0)
                        {
                            <div class="post-tags-layer">
                                <div class="tags-layer">
                                    @foreach (var itag in Model.QuestionTags)
                                    {
                                        <a href="/Tag/@itag.Tag.Trim().Replace(" ","_")"> @itag.Tag </a>
                                    }
                                </div>
                            </div>
                        }
                        <!-- /tags -->

                    </section>
                    <!-- /question content -->

                    <div class="banner-layer">
                        <a href=""><img src="/images/banner-4.jpg"></a>
                    </div>

                    <!-- answer -->
                    <div class="answers-layer">
                        <div class="top-layer">
                            <h4><span> @Model.Answers.Count() </span> پاسخ به این پرسش </h4>
                            <div class="filter-layer">
                                <form action="" method="">
                                    <div class="select-layer">
                                        <select>
                                            <option> جدیدترین پاسخ ها </option>
                                            <option> قدیمی ترین پاسخ ها </option>
                                            <option> پر رای ترین پاسخ ها </option>
                                        </select>
                                    </div>
                                    <button><i class="icon-sort"></i></button>
                                </form>
                            </div>
                        </div>

                       @if (answers != null)
                        {
                            foreach (var item in answers)
                            {
                                <!-- Item -->
                                <div class="answer-item">
                                    <div class="top-detail">
                                        <span><i> @item.CreateDate.ToShamsi() </i></span>
                                        @if (item.UserId == UserId)
                                        {
                                            <a asp-action="EditAnswer" asp-controller="Question" asp-route-id="@item.AnswerId"><i class="icon-pencil-edit"></i></a>
                                        }
                                    </div>
                                    <div class="inner">
                                        <p>
                                            @item.AnswerText
                                        </p>
                                        <div class="rating-layer">
                                            <form class="scoring-layer" action="" method="">
                                                <button class="plus"><i class="icon-caret-up"></i></button>
                                                <span> 12K </span>
                                                <button class="negative"><i class="icon-caret-down"></i></button>
                                            </form>
                                            @if (item.IsTrueAnswer == true || Model.UserId == UserId)
                                            {
                                                <form class="selected-answer">
                                                    <button class="selected" onclick="trueAnswer(@item.QuestionId,@item.AnswerId)"><i class="icon-check"></i></button>
                                                </form>
                                            }
                                            else
                                            {
                                                
                                            }
                                        </div>

                                    </div>

                                    <div class="detail-layer">
                                        <div class="author">
                                            <a href="" class="img-layer">
                                                <img src="/images/Avatars/@item.User?.Avatar">
                                            </a>
                                            <h3><a href=""> @item.User?.UserName </a></h3>
                                            <span><i>@*@item.User.Questions.Count()*@</i> پرسش | <i>@item.User?.Answers?.Count()</i> پاسخ</span>
                                        </div>
                                        <a href="javascript:void(0)"> <i class="icon-back-arrow"></i> ثبت پاسخ </a>
                                    </div>

                                    <!-- reply -->
                                    <!-- item -->
                                    <div class="reply-item">
                                        <div class="inner">
                                            <p> به نظر من این تجزیه و تحلیل شما درست نیست ، پیشنهاد میکنم نگاهی به این لینک بندازید : <a href="">http://bugfixer.com/topic/12/A1dsf5</a> <span> 12 مرداد 1397 در 14:28 </span> </p>
                                            <button><i class="icon-pencil-edit"></i></button>
                                        </div>
                                    </div>
                                    <!-- item -->
                                    <!-- item -->
                                    <div class="reply-item">
                                        <div class="inner">
                                            <p> مرسی بابت توضیح صریحتون ، به نظر من باید از این تگ کاربردی بهتر استفاده بشه <span> 12 مرداد 1397 در 14:28 </span> </p>
                                            <button><i class="icon-pencil-edit"></i></button>
                                        </div>
                                    </div>
                                    <!-- item -->
                                    <!-- item -->
                                    <div class="reply-item">
                                        <div class="inner">
                                            <p> مرسی بابت توضیح صریحتون ، به نظر من باید از این تگ کاربردی بهتر استفاده بشه مرسی بابت توضیح صریحتون ، به نظر من باید از این تگ کاربردی بهتر استفاده بشه مرسی بابت توضیح صریحتون ، به نظر من باید از این تگ کاربردی بهتر استفاده بشه <span> 12 مرداد 1397 در 14:28 </span> </p>
                                            <button><i class="icon-pencil-edit"></i></button>
                                        </div>
                                    </div>
                                    <!-- item -->
                                    <!-- /reply -->

                                </div>
                                <!-- /Item -->
                            }
                        }
                        <!-- pagination -->
                        <div class="pagination-items">
                            <div class="inner">
                                <div class="pages">
                                    <a href="" class="page">1</a>
                                    <a href="" class="page">2</a>
                                    <a href="" class="page current">3</a>
                                    <a href="" class="page">4</a>
                                    <a href="" class="page">5</a>
                                    <a href="" class="page">...</a>
                                    <a href="" class="page last">12564</a>
                                </div>
                            </div>
                        </div>
                        <!-- /pagination -->
                        <!-- submit comment -->
                        <div class="submit-comment" id="submit-comment">
                            <p> متن پاسخ شما </p>
                            @if (User.Identity.IsAuthenticated == true)
                            {
                                <form asp-controller="Question" asp-action="AddAnswer" method="post">
                                    <input type="hidden" name="questionId" value="@Model." />
                                    <textarea name="answer" placeholder=" متن خود را وارد نمایید "></textarea>
                                    <button type="submit"> ارسال پاسخ </button>
                                </form>
                            }
                            else
                            {
                                <div class="alert alert-warning">
                                    <p>برای درج پاسخ ابتدا باید لاگین کنید</p>
                                </div>
                            }
                        </div>
                        <!-- /submit comment -->

                    </div>
                    <!-- /answer -->

                </div>

                <!-- aside -->
                <aside>

                    <a href="/Create-Question" class="ask-question"> ثبت پرسش جدید </a>

                    <section class="related-post-layer">
                        <header><h2> پرسش های مرتبط </h2></header>
                        <div class="inner">
                            <ul>
                                <li class="answered"><span> 2.2K <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="selected"><span> 23 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="answered"><span> 56 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="answered"><span> 56 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="answered"><span> 56 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="answered"><span> 56 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="answered"><span> 56 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                                <li class="answered"><span> 56 <i class="icon-comment-1"></i> </span><a href=""> نحوه ی پیاده سازی فروشگاه اینترنتی با فریم ورک لاراول </a></li>
                            </ul>
                        </div>
                    </section>

                    <!-- most popular post -->
                    <section class="most-popular-questions">

                       @await Component.InvokeAsync("SideBarQuestion")

                    </section>
                    <!-- /most popular post -->
                    <!-- most controversial tags -->
                    <section class="most-controversial-tags">
                        <header><h2> پر بحث ترین تگ ها </h2></header>
                        <div class="tags-layer">
                            <a href=""> Jquery </a>
                            <a href=""> php </a>
                            <a href=""> Javascript </a>
                            <a href=""> asp </a>
                            <a href=""> mvc </a>
                            <a href=""> C# </a>
                            <a href=""> woocommerce </a>
                            <a href=""> Framework </a>
                            <a href=""> Jquery </a>
                            <a href=""> php </a>
                            <a href=""> Framework </a>
                            <a href=""> Jquery </a>
                            <a href=""> php </a>
                            <a href=""> Javascript </a>
                            <a href=""> asp </a>
                            <a href=""> mvc </a>
                            <a href=""> C# </a>
                            <a href=""> woocommerce </a>
                            <a href=""> Framework </a>
                            <a href=""> Jquery </a>
                            <a href=""> Javascript </a>
                        </div>
                    </section>
                    <!-- /most controversial posts -->
                    <!-- banner -->
                    <div class="banner-layer">
                        <a href=""><img src="/images/banner.jpg"></a>
                    </div>
                    <!-- /banner -->
                    <!-- banner -->
                    <div class="banner-layer">
                        <a href=""><img src="/images/banner-2.jpg"></a>
                    </div>
                    <!-- /banner -->

                </aside>
                <!-- /aside -->
                <div class="clearfix"></div>

            </div>

        </div>

    </div>

    <partial name="_Footer" />
    <partial name="_FooterRefrences" />

    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/public.js"></script>
    <script src="/js/question.js"></script>
    <script>
        function AddToFav(id) {
            //url: /Question/AddToFav/1

            $.get("/Question/AddToFav/" + id, function (res) {
                $("#fav_q").html(res);
                $("#span_fav").html(res);
                //$(".icon-star").attr("style","color:#ffb301");
            });
        }

        function Vote(id, vote) {
            $.get("/Question/AddVote/" + id + "?vote=" + vote, function (res) {
                $("#vote_q").html(res);
                $("#vote_span").html(res);
            });
        }

        function trueAnswer(qid, aid) {
            $.get("/Question/AddTrueAnswer/?questionId=" + qid + "&AnswerId=" + aid, function (res) {
                location.reload();
            });
        }
    </script>
</body>
</html>